- query: 'connectivity_map, config: poc3'
  rules:
  - src_ns:
    - default
    src_pods:
    - app in (cartservice,checkoutservice,frontend,loadgenerator,recommendationservice)
    dst_ns:
    - kube-system
    dst_pods:
    - k8s-app in (kube-dns)
    connection:
    - Protocol: UDP
      Ports:
      - '53'
  - src_ns:
    - default
    src_pods:
    - app in (checkoutservice,frontend)
    dst_ns:
    - default
    dst_pods:
    - default/currencyservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '7000'
  - src_ns:
    - default
    src_pods:
    - app in (checkoutservice,frontend)
    dst_ns:
    - default
    dst_pods:
    - default/cartservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '7070'
  - src_ns:
    - default
    src_pods:
    - default/frontend-1
    dst_ns:
    - default
    dst_pods:
    - default/adservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '9555'
  - src_ns:
    - default
    src_pods:
    - app in (checkoutservice,frontend,recommendationservice)
    dst_ns:
    - default
    dst_pods:
    - default/productcatalogservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '3550'
  - src_ns:
    - default
    src_pods:
    - default/checkoutservice-1
    dst_ns:
    - default
    dst_pods:
    - default/paymentservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '50051'
  - src_ns:
    - default
    src_pods:
    - app in (checkoutservice,frontend)
    dst_ns:
    - default
    dst_pods:
    - default/shippingservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '50051'
  - src_ns:
    - default
    src_pods:
    - default/checkoutservice-1
    dst_ns:
    - default
    dst_pods:
    - default/emailservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '8080'
  - src_ns:
    - default
    src_pods:
    - default/frontend-1
    dst_ns:
    - default
    dst_pods:
    - default/recommendationservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '8080'
  - src_ip_block:
    - 0.0.0.0/0
    dst_ns:
    - default
    dst_pods:
    - default/frontend-1
    connection:
    - Protocol: TCP
      Ports:
      - '8080'
  - src_ns:
    - default
    src_pods:
    - default/loadgenerator-1
    dst_ns:
    - default
    dst_pods:
    - default/frontend-1
    connection:
    - Protocol: TCP
      Ports:
      - '8080'
  - src_ns:
    - kube-system
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - default/frontend-1
    connection:
    - Protocol: TCP
      Ports:
      - '8080'
  - src_ns:
    - default
    src_pods:
    - default/cartservice-1
    dst_ns:
    - default
    dst_pods:
    - default/redis-cart-1
    connection:
    - Protocol: TCP
      Ports:
      - '6379'
  - src_ns:
    - default
    src_pods:
    - default/frontend-1
    dst_ns:
    - default
    dst_pods:
    - default/checkoutservice-1
    connection:
    - Protocol: TCP
      Ports:
      - '5050'
