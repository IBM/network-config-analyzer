- query: 'istio-policy2, config: istio-policy2'
  rules:
  - src_ip_block:
    - 1.2.3.0/24
    dst_ns:
    - default
    dst_pods:
    - app in (skydive)
    connection:
    - Protocol: TCP
      Ports:
      - 30
      - 50
  - src_ip_block:
    - 2.2.2.2/32
    dst_ns:
    - default
    dst_pods:
    - app in (skydive)
    connection:
    - Protocol: TCP
      Ports:
      - 30
      - 50
  - src_ns:
    - default
    - kube-system
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - app in (skydive)
    connection:
    - Protocol: TCP
      Ports:
      - 30
      - 50
  - src_ns:
    - default
    src_pods:
    - app in (special_skydive)
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      Ports:
      - 30
      - 50