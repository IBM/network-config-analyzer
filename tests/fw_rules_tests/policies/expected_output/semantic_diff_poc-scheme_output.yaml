- query: 'semantic_diff, config1: allow_all, config2: poc3, key: Removed connections
    between persistent peers'
  rules:
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - kube-system
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
    - Protocol: UDP
      dst_ports:
      - ({1-52,54-65535}, )
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - productcatalogservice
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-3549,3551-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - recommendationservice
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-3549,3551-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - app in (paymentservice,shippingservice)
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-50050,50052-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - checkoutservice
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-5049,5051-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - cartservice
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-6378,6380-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - currencyservice
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-6999,7001-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - cartservice
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-7069,7071-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - app in (emailservice,recommendationservice)
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-8079,8081-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - loadgenerator
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-8079,8081-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - kube-system
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-8079,8081-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - adservice
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-9554,9556-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - loadgenerator
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ns:
    - kube-system
    dst_pods:
    - etcd-operator
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - app not in (cartservice,checkoutservice,frontend,loadgenerator,recommendationservice)
    dst_ns:
    - default
    - kube-system
    dst_pods:
    - '*'
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - cartservice
    dst_ns:
    - default
    dst_pods:
    - app not in (cartservice,loadgenerator,redis-cart)
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - checkoutservice
    dst_ns:
    - default
    dst_pods:
    - app in (adservice,frontend,recommendationservice,redis-cart)
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - frontend
    dst_ns:
    - default
    dst_pods:
    - app in (emailservice,paymentservice,redis-cart)
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - loadgenerator
    dst_ns:
    - default
    dst_pods:
    - app not in (frontend,loadgenerator)
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - recommendationservice
    dst_ns:
    - default
    dst_pods:
    - app not in (loadgenerator,productcatalogservice,recommendationservice)
    connection:
    - All connections
  - src_ns:
    - kube-system
    src_pods:
    - '*'
    dst_ns:
    - default
    dst_pods:
    - app not in (frontend)
    connection:
    - All connections
- query: 'semantic_diff, config1: allow_all, config2: poc3, key: Removed connections
    between persistent peers and ipBlocks'
  rules:
  - src_ip_block:
    - 0.0.0.0/0
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-8079,8081-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ip_block:
    - ::/0
    dst_ns:
    - default
    dst_pods:
    - '*'
    connection:
    - Protocol: TCP
      dst_ports:
      - ({1-8079,8081-65535}, )
    - Protocol: UDP
    - Protocol: SCTP
  - src_ip_block:
    - 0.0.0.0/0
    dst_ns:
    - default
    dst_pods:
    - app not in (frontend)
    connection:
    - All connections
  - src_ip_block:
    - ::/0
    dst_ns:
    - default
    dst_pods:
    - app not in (frontend)
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ip_block:
    - 0.0.0.0/0
    connection:
    - All connections
  - src_ns:
    - default
    src_pods:
    - '*'
    dst_ip_block:
    - ::/0
    connection:
    - All connections

